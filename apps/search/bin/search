#!/usr/bin/env python

'''
CloudSight Elasticsearch search service
'''

import os
import sys
_my_dir = os.path.abspath(os.path.dirname(sys.argv[0]))
_base_dir = os.path.abspath(os.path.join(_my_dir, '..')) 
sys.path.append(_base_dir)


import logging

logger = logging.getLogger("elk_cloudsight.search")
logger.setLevel(logging.DEBUG)
 
# create console handler
handler = logging.StreamHandler()

# create formatter
formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s: %(message)s')

# add formatter to handler
handler.setFormatter(formatter)

# add handler to logger
logger.addHandler(handler)

import search.cli.search_cli
import search.endpoint.rest_endpoint

if __name__ == '__main__':
    config = search.cli.search_cli.SearchCLI().parse_arguments()
    if config.is_verbose():
        handler.setLevel(logging.DEBUG)
    else:
        handler.setLevel(logging.INFO)
    
    search.endpoint.rest_endpoint.main(config)
