#!/bin/bash

#
# (c) IBM Research 2015
# Vulnerability Advisor component host assignments
#

REGCRAWLER="cloudsight-regcrawler"

declare -A CONTAINER_COUNTS=(
        [$ES_CONT]=5
        [$KAFKA_CONT]=1
        [$INDEXER_CONT]=2
        [$SEARCH_CONT]=0
        [$CONFIG_PARSER_CONT]=2
        [$COMPLIANCE_INDEXER_CONT]=2
        [$COMPLIANCE_ANNOTATOR_CONT]=2
        [$VULNERABILITY_INDEXER_CONT]=2
        [$VULNERABILITY_ANNOTATOR_CONT]=2
        [$NOTIFICATION_PROCESSOR_CONT]=1
        [$PASSWORD_ANNOTATOR_CONT]=2
        [$NOTIFICATION_INDEXER_CONT]=2
        [$USNCRAWLER_CONT]=1
        [$REGCRAWLER]=3
        [$REGISTRY_UPDATE_CONT]=3
        [$REGISTRY_MONITOR_CONT]=1
        [$IMAGE_RESCANNER_CONT]=0
        )

declare -A CONTAINER_HOSTS=(
        ["$ES_CONT.1"]=$ES1
        ["$ES_CONT.2"]=$ES2
        ["$ES_CONT.3"]=$ES3
        ["$ES_CONT.4"]=$ES4
        ["$ES_CONT.5"]=$ES5
        ["$KAFKA_CONT.1"]=$KAFKA1
        ["$INDEXER_CONT.1"]=$INDEXER1
        ["$INDEXER_CONT.2"]=$INDEXER2
        ["$SEARCH_CONT.1"]=$SEARCH1
        ["$CONFIG_PARSER_CONT.1"]=$ANNOTATOR1
        ["$CONFIG_PARSER_CONT.2"]=$ANNOTATOR2
        ["$CONFIG_PARSER_CONT.3"]=$ANNOTATOR3
        ["$COMPLIANCE_INDEXER_CONT.1"]=$INDEXER2
        ["$COMPLIANCE_INDEXER_CONT.2"]=$INDEXER3
        ["$COMPLIANCE_ANNOTATOR_CONT.1"]=$ANNOTATOR1
        ["$COMPLIANCE_ANNOTATOR_CONT.2"]=$ANNOTATOR3
        ["$VULNERABILITY_INDEXER_CONT.1"]=$INDEXER1
        ["$VULNERABILITY_INDEXER_CONT.2"]=$INDEXER3
        ["$VULNERABILITY_ANNOTATOR_CONT.1"]=$ANNOTATOR2
        ["$VULNERABILITY_ANNOTATOR_CONT.2"]=$ANNOTATOR3
        ["$NOTIFICATION_PROCESSOR_CONT.1"]=$ANNOTATOR1
        ["$NOTIFICATION_PROCESSOR_CONT.2"]=$ANNOTATOR2
        ["$PASSWORD_ANNOTATOR_CONT.1"]=$ANNOTATOR1
        ["$PASSWORD_ANNOTATOR_CONT.2"]=$ANNOTATOR3
        ["$NOTIFICATION_INDEXER_CONT.1"]=$INDEXER1
        ["$NOTIFICATION_INDEXER_CONT.2"]=$INDEXER2
        ["$USNCRAWLER_CONT.1"]=$ANNOTATOR1
        ["$REGCRAWLER.1"]=$REGCRAWL1
        ["$REGCRAWLER.2"]=$REGCRAWL2
        ["$REGCRAWLER.3"]=$REGCRAWL3
        ["$REGISTRY_UPDATE_CONT.1"]=$REGCRAWL1
        ["$REGISTRY_UPDATE_CONT.2"]=$REGCRAWL2
        ["$REGISTRY_UPDATE_CONT.3"]=$REGCRAWL3
        ["$REGISTRY_MONITOR_CONT.1"]=$REGCRAWL1
        ["$VASTAT_REPORTER_CONT.1"]=$POLICY1
        ["$IMAGE_RESCANNER_CONT.1"]=$POLICY1
        )

declare -A WRITABLE_CLUSTER_NODES=(
        [$ES_CONT]=5 #${CONTAINER_COUNTS[$ES_CONT]}
        [$KAFKA_CONT]=1 #${CONTAINER_COUNTS[$KAFKA_CONT]}
        )

CONTAINER_STARTUP_ORDER=($ES_CONT $KAFKA_CONT $INDEXER_CONT \
      $COMPLIANCE_INDEXER_CONT $VULNERABILITY_INDEXER_CONT \
      $NOTIFICATION_INDEXER_CONT $NOTIFICATION_PROCESSOR_CONT \
      $USNCRAWLER_CONT $COMPLIANCE_ANNOTATOR_CONT \
      $VULNERABILITY_ANNOTATOR_CONT $CONFIG_PARSER_CONT \
      $PASSWORD_ANNOTATOR_CONT $REGCRAWLER \
      $REGISTRY_UPDATE_CONT $REGISTRY_MONITOR_CONT \
      $SEARCH_CONT \
      $VASTAT_REPORTER_CONT \
      $IMAGE_RESCANNER_CONT \
      )
